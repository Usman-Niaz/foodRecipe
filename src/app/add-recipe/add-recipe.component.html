<div class="mb-10">
  <p-toast></p-toast>
  <div
    class="w-[95%] md:w-[75%] lg:w-[60%] mx-auto mt-10 p-5 border-2 border-gray-300 shadow-lg rounded-lg bg-gray-200"
  >
    <h1 class="text-gray-700 text-2xl font-bold mb-4 text-center">
      {{ "addRecipe.addNewRecipe" | translate }}
    </h1>

    <form [formGroup]="recipeForm" (ngSubmit)="submitRecipeForm()">
      <!-- Dropdown with background color change -->
      <p-dropdown
        formControlName="selectedCategory"
        name="selectedCategory"
        [options]="getTranslatedFoodOptions()"
        optionLabel="name"
        [placeholder]="'addRecipe.selectFoodType' | translate"
        class="border !bg-gray-500 w-full !mb-4"
        panelStyleClass="!bg-gray-500"
      ></p-dropdown>
      @if (recipeForm.get('selectedCategory')?.touched &&
      recipeForm.get('selectedCategory')?.invalid) {
        <small class="text-red-600 block mb-2">
          {{ "addRecipe.selectFoodType" | translate }} is required
        </small>
      }

      <!-- Title input field -->
      <p-floatlabel variant="on">
        <label for="on_label4" class="!bg-gray-500">
          {{ "addRecipe.title" | translate }}
        </label>
        <input
          formControlName="title"
          name="title"
          pInputText
          autocomplete="off"
          class="!bg-gray-500 w-full !mb-4"
        />
      </p-floatlabel>
      @if (recipeForm.get('title')?.touched && recipeForm.get('title')?.invalid) {
        <small class="text-red-600 block mb-2">Title is required</small>
      }

      <!-- Description textarea field -->
      <p-floatlabel variant="on">
        <textarea
          pTextarea
          formControlName="description"
          name="description"
          rows="5"
          cols="30"
          style="resize: none"
          class="!bg-gray-500 w-full !mb-4"
        ></textarea>
        <label for="on_label" class="!bg-gray-500">
          {{ "addRecipe.description" | translate }}
        </label>
      </p-floatlabel>
      @if (recipeForm.get('description')?.touched &&
      recipeForm.get('description')?.invalid) {
        <small class="text-red-600 block mb-2">Description is required</small>
      }

      <!-- Ingredients field -->
      <p-floatlabel variant="on">
        <textarea
          pTextarea
          formControlName="ingredients"
          name="ingredients"
          rows="5"
          cols="30"
          style="resize: none"
          class="!bg-gray-500 w-full !mb-4"
        ></textarea>
        <label for="on_label" class="!bg-gray-500">
          {{ "addRecipe.ingredients" | translate }}
        </label>
      </p-floatlabel>
      @if (recipeForm.get('ingredients')?.touched &&
      recipeForm.get('ingredients')?.invalid) {
        <small class="text-red-600 block mb-2">Ingredients are required</small>
      }

      <!-- Recipe field -->
      <p-floatlabel variant="on">
        <textarea
          pTextarea
          formControlName="recpe"
          name="recpe"
          rows="5"
          cols="30"
          style="resize: none"
          class="!bg-gray-500 w-full !mb-4"
        ></textarea>
        <label for="on_label" class="!bg-gray-500">
          {{ "addRecipe.recipe" | translate }}
        </label>
      </p-floatlabel>
      @if (recipeForm.get('recpe')?.touched &&
      recipeForm.get('recpe')?.invalid) {
        <small class="text-red-600 block mb-2">Recipe is required</small>
      }

      <!-- Image upload -->
      <div class="flex flex-row items-center justify-between gap-4">
        <p-fileupload
          name="image"
          mode="basic"
          [chooseLabel]="'addRecipe.chooseImage' | translate"
          chooseIcon="pi pi-upload"
          accept="image/*"
          maxFileSize="1000000"
          (onSelect)="handleImageSelect($event)"
        ></p-fileupload>

        <!-- Show error manually -->
        @if (imageError) {
          <small class="text-red-600 block mb-2">Image is required</small>
        }

        <!-- Image preview -->
        @if (selectedImage) {
          <div class="ml-auto">
            <img
              [src]="selectedImage"
              alt="Selected"
              class="w-40 h-40 object-cover rounded border"
            />
          </div>
        }
      </div>

      <!-- Submit Button -->
      <div class="flex justify-center mt-6">
        <button
          [disabled]="submitting"
          type="submit"
          class="bg-green-500 hover:bg-green-700 text-white font-semibold py-2 px-6 rounded shadow"
        >
          {{ "addRecipe.addRecipeBtn" | translate }}
        </button>
      </div>
    </form>
  </div>
</div>
